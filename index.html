<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Imports Company - Produtos Importados Originais">
    <title>Imports Company | Luxo e Exclusividade</title>

    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Playfair+Display:wght@400;500;600;700&display=swap"
        rel="stylesheet">

    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="styles.css?v=2026">
    <style>
        /* Carousel Styles */
        .hero {
            position: relative;
            height: 100vh;
            min-height: 600px;
            overflow: hidden;
            background: #000;
        }

        .carousel-container {
            width: 100%;
            height: 100%;
            position: relative;
        }

        .carousel-track {
            width: 100%;
            height: 100%;
            position: relative;
        }

        .carousel-slide {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-size: cover;
            background-position: center;
            opacity: 0;
            transition: opacity 0.8s ease-in-out;
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1;
        }

        .carousel-slide::before {
            content: '';
            position: absolute;
            inset: 0;
            background: rgba(0, 0, 0, 0.4);
            /* Overlay */
            z-index: 1;
        }

        .carousel-slide.active {
            opacity: 1;
            z-index: 2;
        }

        .hero-content {
            position: relative;
            z-index: 3;
            text-align: center;
            max-width: 800px;
            padding: 20px;
            animation: slideUp 0.8s ease-out 0.3s backwards;
        }

        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .carousel-btn {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            background: rgba(255, 255, 255, 0.1);
            color: white;
            border: 1px solid rgba(255, 255, 255, 0.2);
            width: 50px;
            height: 50px;
            border-radius: 50%;
            font-size: 1.2rem;
            cursor: pointer;
            z-index: 10;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .carousel-btn:hover {
            background: var(--gold);
            color: #000;
            border-color: var(--gold);
        }

        .carousel-btn.prev {
            left: 20px;
        }

        .carousel-btn.next {
            right: 20px;
        }

        .carousel-indicators {
            position: absolute;
            bottom: 30px;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            gap: 10px;
            z-index: 10;
        }

        .carousel-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.3);
            cursor: pointer;
            transition: all 0.3s;
        }

        .hero-airplane {
            font-size: 2.5rem;
            color: var(--gold);
            filter: drop-shadow(0 0 15px rgba(197, 160, 89, 0.8));
            position: absolute;
            top: 15%;
            right: 15%;
            transform: rotate(-45deg);
            opacity: 0.8;
            animation: planeFloat 4s infinite ease-in-out;
        }

        @keyframes planeFloat {

            0%,
            100% {
                transform: rotate(-45deg) translateY(0);
            }

            50% {
                transform: rotate(-45deg) translateY(-15px);
            }
        }

        .carousel-dot.active {
            background: var(--gold);
            transform: scale(1.2);
        }

        @media(max-width: 768px) {
            .hero {
                height: 85vh;
                /* Aumentado para caber o banner vertical inteiro */
                min-height: 500px;
            }

            .hero-content {
                padding: 10px;
                width: 95% !important;
            }

            .hero-content img {
                width: 70px !important;
                height: 70px !important;
            }

            .hero-title {
                font-size: 1.6rem !important;
                line-height: 1.2;
                word-wrap: break-word;
            }

            .hero-subtitle {
                font-size: 0.65rem !important;
                letter-spacing: 2px !important;
                margin-bottom: 5px;
            }

            .hero-desc {
                font-size: 0.8rem !important;
                margin-bottom: 12px !important;
                display: -webkit-box;
                -webkit-line-clamp: 2;
                line-clamp: 2;
                -webkit-box-orient: vertical;
                overflow: hidden;
            }

            .hero .btn {
                padding: 8px 16px;
                font-size: 0.85rem;
            }

            .carousel-btn {
                display: none;
            }
        }

        /* Home Categories Grid */
        .categories-grid-home {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 25px;
            margin-top: 40px;
        }

        .category-card {
            background: white;
            padding: 30px 20px;
            border-radius: 15px;
            text-align: center;
            transition: all 0.3s;
            cursor: pointer;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
            border: 1px solid transparent;
        }

        .category-card:hover {
            transform: translateY(-10px);
            border-color: var(--gold);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
        }

        .category-icon {
            width: 70px;
            height: 70px;
            background: #f0f0f0;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 20px;
            font-size: 1.8rem;
            color: var(--primary);
            transition: all 0.3s;
        }

        .category-card:hover .category-icon {
            background: var(--gold);
            color: white;
        }

        .category-card h3 {
            font-size: 1.2rem;
            margin-bottom: 10px;
            color: #1a2744;
        }

        .category-card p {
            font-size: 0.9rem;
            color: #666;
            line-height: 1.4;
        }

        /* Product Modal Gallery Thumbs */
        .product-gallery-thumbs {
            display: flex;
            gap: 10px;
            margin-top: 15px;
            overflow-x: auto;
            padding: 5px;
            justify-content: center;
            max-width: 100%;
        }

        .thumb-item {
            width: 65px;
            height: 65px;
            border-radius: 8px;
            cursor: pointer;
            border: 2px solid #eee;
            transition: all 0.2s;
            object-fit: cover;
            flex-shrink: 0;
            opacity: 0.7;
        }

        .thumb-item:hover,
        .thumb-item.active {
            border-color: var(--gold);
            opacity: 1;
            transform: scale(1.05);
        }
    </style>
</head>

<body>

    <!-- Header -->
    <header class="header" id="header">
        <div class="container header-content">
            <div class="logo">
                <a href="#"><img src="images/logo.jpg" alt="Imports Company"
                        onerror="this.src='https://placehold.co/50x50?text=IC'"></a>
            </div>

            <nav class="nav-desktop">
                <ul>
                    <li><a href="#home" class="active">Início</a></li>
                    <li><a href="#products">Produtos</a></li>
                    <li><a href="#categories">Categorias</a></li>
                    <li><a href="#about">Sobre</a></li>
                    <li><a href="#contact">Contato</a></li>
                </ul>
            </nav>

            <div class="header-icons">
                <a href="#" class="icon-btn search-toggle"><i class="fas fa-search"></i></a>
                <a href="cart.html" class="icon-btn cart-toggle">
                    <i class="fas fa-shopping-bag"></i>
                    <span class="cart-count">0</span>
                </a>
                <button class="menu-toggle" aria-label="Menu Mobile"><i class="fas fa-bars"></i></button>
            </div>
        </div>

        <!-- Mobile Menu (Hidden by default) -->
        <nav class="mobile-nav">
            <a href="#home">Início</a>
            <a href="#products">Produtos</a>
            <a href="#categories">Categorias</a>
            <a href="#about">Sobre</a>
            <a href="#contact">Contato</a>
            <a href="cart.html"><i class="fas fa-shopping-bag"></i> Carrinho</a>
        </nav>
    </header>

    <!-- Hero Section with Carousel -->
    <section class="hero" id="home">
        <div class="carousel-container">
            <div class="carousel-track" id="hero-track">
                <!-- Slide 1: Realize seus sonhos (NOVO) -->
                <div class="carousel-slide active"
                    style="background: linear-gradient(135deg, #0f172a 0%, #020617 100%); position: relative;">
                    <i class="fas fa-plane-departure hero-airplane"></i>
                    <div class="hero-content">
                        <div style="margin-bottom: 20px;">
                            <img src="images/logo.jpg" alt="Logo"
                                style="width: 120px; height: 120px; border-radius: 50%; border: 3px solid var(--gold); box-shadow: 0 0 40px rgba(197, 160, 89, 0.4);">
                        </div>
                        <span class="hero-subtitle"
                            style="color: var(--gold); letter-spacing: 5px; font-weight: 300;">IMPORTS COMPANY</span>
                        <h1 class="hero-title"
                            style="font-family: 'Playfair Display', serif; text-transform: uppercase; letter-spacing: 2px; text-shadow: 0 10px 30px rgba(0,0,0,0.5);">
                            Realize Seus <span class="gold-text"
                                style="color: var(--gold); text-shadow: 0 0 20px rgba(197, 160, 89, 0.4);">Sonhos</span>
                        </h1>
                        <p class="hero-desc" style="opacity: 0.9;">Trazendo o melhor do mundo
                            diretamente para você com exclusividade e sofisticação.</p>
                        <a href="#products" class="btn">Explorar Agora <i class="fas fa-arrow-right"></i></a>
                    </div>
                </div>

                <!-- Slide 2: Existente -->
                <div class="carousel-slide" style="background-image: url('images/hero_banner_full.png');">
                    <div class="hero-content">
                        <span class="hero-subtitle">Nova Coleção 2026</span>
                        <h1 class="hero-title">Estilo <span class="gold-text">Que Define</span></h1>
                        <p class="hero-desc">Peças exclusivas importadas diretamente das melhores marcas mundiais.</p>
                        <a href="#products" class="btn">Ver Coleção <i class="fas fa-arrow-right"></i></a>
                    </div>
                </div>
            </div>

            <button class="carousel-btn prev" onclick="moveSlide(-1)"><i class="fas fa-chevron-left"></i></button>
            <button class="carousel-btn next" onclick="moveSlide(1)"><i class="fas fa-chevron-right"></i></button>

            <div class="carousel-indicators" id="hero-indicators"></div>
        </div>
    </section>

    <!-- Categories Section -->
    <section class="section" id="categories" style="background: #f8f9fa;">
        <div class="container">
            <div class="section-header">
                <span class="section-label">Coleções</span>
                <h2 class="section-title">Navegue por <span class="gold-text">Categorias</span></h2>
                <div style="width: 60px; height: 3px; background: var(--gold); margin: 20px auto;"></div>
            </div>
            <div class="categories-grid-home" id="categories-container">
                <!-- Injetado via JS -->
                <div class="loading-simple">Carregando categorias...</div>
            </div>
        </div>
    </section>

    <!-- Products Section -->
    <section class="section" id="products">
        <div class="container">
            <div class="section-header">
                <span class="section-label">Destaques</span>
                <h2 class="section-title">Produtos em <span class="gold-text">Alta</span></h2>
                <div style="width: 60px; height: 3px; background: var(--gold); margin: 20px auto;"></div>
            </div>

            <!-- Static Products Grid (No JS Required) -->
            <div class="products-grid">

                <!-- P1: Camisa Tommy -->
                <article class="product-card">
                    <span class="badge badge-hot">Mais Vendido</span>
                    <div class="product-image-wrapper">
                        <img src="images/banner_raw_2.jpg" alt="Camisa Tommy Hilfiger" class="product-img"
                            onerror="this.onerror=null;this.src='images/placeholder.png';">
                    </div>
                    <div class="product-details">
                        <span class="product-category">Moda Masculina</span>
                        <h3 class="product-title">Camisa Tommy Hilfiger Listrada</h3>
                        <div class="product-price">
                            <span class="price-old">R$ 499,90</span>
                            <span class="price-current">R$ 389,90</span>
                            <span class="installment">ou 12x de R$ 32,49</span>
                        </div>
                        <button class="add-to-cart-btn"><i class="fas fa-shopping-bag"></i> Adicionar</button>
                    </div>
                </article>

                <!-- P2: Malha Tommy -->
                <article class="product-card">
                    <span class="badge badge-new">Novo</span>
                    <div class="product-image-wrapper">
                        <img src="images/banner_raw_1.jpg" alt="Malha Tommy Hilfiger" class="product-img"
                            onerror="this.onerror=null;this.src='images/placeholder.png';">
                    </div>
                    <div class="product-details">
                        <span class="product-category">Moda Masculina</span>
                        <h3 class="product-title">Malha Tommy Hilfiger Cinza</h3>
                        <div class="product-price">
                            <span class="price-old">R$ 699,90</span>
                            <span class="price-current">R$ 549,90</span>
                            <span class="installment">ou 12x de R$ 45,82</span>
                        </div>
                        <button class="add-to-cart-btn"><i class="fas fa-shopping-bag"></i> Adicionar</button>
                    </div>
                </article>

                <!-- P3: T-Shirt Tommy -->
                <article class="product-card">
                    <span class="badge badge-sale">Oferta</span>
                    <div class="product-image-wrapper">
                        <img src="images/banner_female.jpg" alt="T-Shirt Tommy Feminina" class="product-img"
                            onerror="this.onerror=null;this.src='images/placeholder.png';">
                    </div>
                    <div class="product-details">
                        <span class="product-category">Moda Feminina</span>
                        <h3 class="product-title">T-Shirt Tommy Signature</h3>
                        <div class="product-price">
                            <span class="price-old">R$ 349,90</span>
                            <span class="price-current">R$ 289,90</span>
                            <span class="installment">ou 12x de R$ 24,16</span>
                        </div>
                        <button class="add-to-cart-btn"><i class="fas fa-shopping-bag"></i> Adicionar</button>
                    </div>
                </article>

                <!-- P4: Bolsa Michael Kors -->
                <article class="product-card">
                    <span class="badge badge-hot">Premium</span>
                    <div class="product-image-wrapper">
                        <img src="images/banner_bag_black.jpg" alt="Bolsa Michael Kors" class="product-img"
                            onerror="this.onerror=null;this.src='images/placeholder.png';">
                    </div>
                    <div class="product-details">
                        <span class="product-category">Acessórios</span>
                        <h3 class="product-title">Bolsa Michael Kors Black</h3>
                        <div class="product-price">
                            <span class="price-old">R$ 1.899,00</span>
                            <span class="price-current">R$ 1.499,00</span>
                            <span class="installment">ou 12x de R$ 124,92</span>
                        </div>
                        <button class="add-to-cart-btn"><i class="fas fa-shopping-bag"></i> Adicionar</button>
                    </div>
                </article>

                <!-- P5: Bolsa Crossbody -->
                <article class="product-card">
                    <span class="badge badge-new">Lançamento</span>
                    <div class="product-image-wrapper">
                        <img src="images/banner_bag_brown.jpg" alt="Bolsa Crossbody" class="product-img"
                            onerror="this.onerror=null;this.src='images/placeholder.png';">
                    </div>
                    <div class="product-details">
                        <span class="product-category">Acessórios</span>
                        <h3 class="product-title">Bolsa MK Crossbody Brown</h3>
                        <div class="product-price">
                            <span class="price-old">R$ 1.599,00</span>
                            <span class="price-current">R$ 1.299,00</span>
                            <span class="installment">ou 12x de R$ 108,25</span>
                        </div>
                        <button class="add-to-cart-btn"><i class="fas fa-shopping-bag"></i> Adicionar</button>
                    </div>
                </article>

                <!-- P6: Camisa Floral -->
                <article class="product-card">
                    <span class="badge badge-sale">-25%</span>
                    <div class="product-image-wrapper">
                        <img src="images/banner_raw_4.jpg" alt="Camisa Floral" class="product-img"
                            onerror="this.onerror=null;this.src='images/placeholder.png';">
                    </div>
                    <div class="product-details">
                        <span class="product-category">Moda Feminina</span>
                        <h3 class="product-title">Camisa Floral Primavera</h3>
                        <div class="product-price">
                            <span class="price-old">R$ 389,00</span>
                            <span class="price-current">R$ 299,00</span>
                            <span class="installment">ou 12x de R$ 24,92</span>
                        </div>
                        <button class="add-to-cart-btn"><i class="fas fa-shopping-bag"></i> Adicionar</button>
                    </div>
                </article>

            </div>

            <div style="text-align: center; margin-top: 60px;">
                <a href="#" class="btn">Ver Todos os Produtos</a>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <div class="footer-grid">
                <div class="footer-col">
                    <h3>Imports Company</h3>
                    <p style="opacity: 0.8; font-size: 0.9rem;">Sua loja definitiva para produtos importados de alta
                        qualidade. Trazendo o melhor do mundo para você.</p>
                </div>
                <div class="footer-col">
                    <h3>Atendimento</h3>
                    <ul class="footer-links">
                        <li><a href="#">Trocas e Devoluções</a></li>
                        <li><a href="#">Política de Frete</a></li>
                        <li><a href="#">Rastrear Pedido</a></li>
                        <li><a href="#">Fale Conosco</a></li>
                    </ul>
                </div>
                <div class="footer-col">
                    <h3>Redes Sociais</h3>
                    <div style="display: flex; gap: 15px; font-size: 1.2rem;">
                        <a href="#"><i class="fab fa-instagram"></i></a>
                        <a href="#"><i class="fab fa-facebook"></i></a>
                        <a href="#"><i class="fab fa-tiktok"></i></a>
                    </div>
                </div>
            </div>
            <div class="footer-bottom">
                &copy; 2026 Imports Company. Todos os direitos reservados.
            </div>
        </div>
    </footer>

    <!-- Product Preview Modal -->
    <div id="productModal" class="product-modal">
        <div class="modal-content">
            <span class="modal-close">&times;</span>
            <div class="modal-grid">

                <!-- Image Side with Zoom -->
                <div class="modal-image-container" id="modalImageContainer">
                    <img id="modalImage" src="" alt="Produto" class="modal-main-img">
                    <div id="zoomLens" class="zoom-lens"></div>
                    <div id="zoomResult" class="zoom-result"></div>
                    <div class="zoom-hint"><i class="fas fa-search-plus"></i> Passe o mouse para zoom</div>

                    <!-- NOVO: Carrossel de Miniaturas -->
                    <div class="product-gallery-thumbs" id="productThumbs"></div>
                </div>

                <!-- Info Side -->
                <div class="modal-info">
                    <span id="modalCategory" class="product-category">Categoria</span>
                    <h2 id="modalTitle" style="margin: 10px 0; font-size: 2rem; color: #1a2744;">Nome do Produto</h2>

                    <div style="margin: 20px 0; padding-bottom: 20px; border-bottom: 1px solid #eee;">
                        <span id="modalOldPrice" class="price-old" style="margin-right: 10px;">R$ 0,00</span>
                        <span id="modalPrice" class="price-current" style="display: inline-block;">R$ 0,00</span>
                        <div id="modalInstallment" class="installment" style="margin-top: 5px;">ou 12x de R$ 0,00</div>
                    </div>

                    <div style="margin: 20px 0;">
                        <label
                            style="font-weight: bold; display: block; margin-bottom: 10px; color: #1a2744;">Tamanho:</label>
                        <div style="display: flex; gap: 10px;">
                            <button class="size-btn" onclick="selectSize(this)">P</button>
                            <button class="size-btn selected" onclick="selectSize(this)">M</button>
                            <button class="size-btn" onclick="selectSize(this)">G</button>
                            <button class="size-btn" onclick="selectSize(this)">GG</button>
                        </div>
                    </div>

                    <div style="margin: 20px 0;">
                        <label style="font-weight: bold; display: block; margin-bottom: 10px; color: #1a2744;">Cor:
                            <span id="selected-color-name"
                                style="font-weight: normal; color: #666; margin-left: 5px;"></span></label>
                        <div class="color-options">
                            <button class="color-btn selected" style="background-color: #000;"
                                onclick="selectColor(this)"></button>
                            <button class="color-btn" style="background-color: #fff; border: 1px solid #ddd;"
                                onclick="selectColor(this)"></button>
                            <button class="color-btn" style="background-color: #1a2744;"
                                onclick="selectColor(this)"></button>
                        </div>
                    </div>

                    <div class="modal-actions">
                        <button class="btn-buy-now" onclick="checkout()">
                            <i class="fas fa-lock"></i> COMPRAR AGORA
                        </button>

                        <button class="btn-whatsapp" onclick="buyWhatsapp()">
                            <i class="fab fa-whatsapp"></i> COMPRAR PELO WHATSAPP
                        </button>
                    </div>

                    <div
                        style="margin-top: 20px; font-size: 0.9rem; color: #555; display: flex; align-items: center; gap: 10px; background: #f8f9fa; padding: 10px; border-radius: 8px;">
                        <i class="fas fa-truck" style="color: #1a2744;"></i>
                        <span>Frete Grátis & Entrega Segura para todo Brasil</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="script.js?v=2026_final_v2"></script>
    <script src="admin-loader.js?v=admin_v2"></script>

    <script>
        // ==========================================
        // Lógica do Modal de Produto (Zoom & Compra)
        // ==========================================

        const modal = document.getElementById("productModal");
        const closeBtn = document.querySelector(".modal-close");
        const modalImg = document.getElementById("modalImage");
        const lens = document.getElementById("zoomLens");
        const result = document.getElementById("zoomResult");
        const container = document.getElementById("modalImageContainer");

        let currentProductToken = null;

        // Init Cart Count
        document.addEventListener('DOMContentLoaded', () => {
            const cart = JSON.parse(localStorage.getItem('cart')) || [];
            if (cart.length > 0) updateCartCount(cart.length);
        });

        // Fechar Modal
        closeBtn.onclick = () => modal.style.display = "none";
        window.onclick = (e) => { if (e.target == modal) modal.style.display = "none"; };

        // Abrir Modal com dados do Produto
        function openProductModal(data) {
            currentProductToken = data.yampi_token || null;
            const mainImg = document.getElementById("modalImage");
            mainImg.src = data.img;
            document.getElementById("modalTitle").innerText = data.title;
            document.getElementById("modalPrice").innerText = data.price;
            document.getElementById("modalOldPrice").innerText = data.oldPrice;
            document.getElementById("modalInstallment").innerText = data.installment;
            document.getElementById("modalCategory").innerText = data.category;

            // Renderizar Miniaturas (Carrossel)
            const thumbContainer = document.getElementById('productThumbs');
            thumbContainer.innerHTML = '';

            // Unir a imagem principal com a galeria (removendo duplicatas)
            const allImages = [...new Set([data.img, ...(data.images || [])])];

            if (allImages.length > 1) {
                allImages.forEach((src, index) => {
                    const img = document.createElement('img');
                    img.src = src;
                    img.className = `thumb-item ${src === data.img ? 'active' : ''}`;
                    img.onclick = () => {
                        mainImg.style.opacity = '0.5';
                        setTimeout(() => {
                            mainImg.src = src;
                            result.style.backgroundImage = `url('${src}')`;
                            mainImg.style.opacity = '1';
                        }, 150);

                        document.querySelectorAll('.thumb-item').forEach(t => t.classList.remove('active'));
                        img.classList.add('active');
                    };
                    thumbContainer.appendChild(img);
                });
            }

            // Configurar Zoom
            result.style.backgroundImage = `url('${data.img}')`;

            // RENDERIZAR VARIANTES (Tamanhos e Cores)
            const sizeContainer = document.querySelector('.size-btn').parentNode;
            const colorContainer = document.querySelector('.color-options');

            // Limpar containers
            sizeContainer.innerHTML = '';
            colorContainer.innerHTML = '';

            if (data.variants && data.variants.length > 0) {
                // Extrair tamanhos e cores únicos
                const sizes = [...new Set(data.variants.map(v => v.size).filter(s => s))];

                // Extrair cores únicas (mantendo o hex e imagem se existir)
                const uniqueColors = [];
                const colorNames = new Set();

                data.variants.forEach(v => {
                    const cName = v.color ? v.color.toLowerCase() : '';
                    if (cName && !colorNames.has(cName)) {
                        colorNames.add(cName);
                        uniqueColors.push({ name: v.color, hex: v.colorHex, image: v.image });
                    } else if (cName) {
                        // Se a cor já existe, mas a variante atual tem imagem e a salva não, atualiza
                        const existing = uniqueColors.find(u => u.name.toLowerCase() === cName);
                        if (existing && !existing.image && v.image) {
                            existing.image = v.image;
                        }
                    }
                });

                // Renderizar Tamanhos
                if (sizes.length > 0) {
                    sizes.forEach((size, index) => {
                        const btn = document.createElement('button');
                        btn.className = `size-btn ${index === 0 ? 'selected' : ''}`;
                        btn.innerText = size;
                        btn.onclick = () => selectSize(btn);
                        sizeContainer.appendChild(btn);
                    });
                } else {
                    sizeContainer.innerHTML = '<span style="color:#666; font-size: 0.9rem;">Tamanho Único</span>';
                }

                // Renderizar Cores
                if (uniqueColors.length > 0) {
                    uniqueColors.forEach((colorObj, index) => {
                        const btn = document.createElement('button');
                        btn.className = `color-btn ${index === 0 ? 'selected' : ''}`;

                        const colorName = colorObj.name;
                        const colorHex = colorObj.hex;

                        // Guardar imagem no dataset
                        if (colorObj.image) {
                            btn.dataset.image = colorObj.image;
                        }

                        // Tentar adivinhar a cor CSS ou usar o hex salvo
                        const colorMap = {
                            'preto': '#000', 'branca': '#fff', 'branco': '#fff', 'azul': '#0000FF',
                            'vermelho': '#FF0000', 'verde': '#008000', 'cinza': '#808080', 'rosa': '#FFC0CB',
                            'amarelo': '#FFFF00', 'laranja': '#FFA500', 'roxo': '#800080', 'marrom': '#A52A2A',
                            'bege': '#F5F5DC', 'vinho': '#800000', 'azul marinho': '#000080', 'verde militar': '#4B5320'
                        };

                        const cssColor = colorHex || colorMap[colorName.toLowerCase()] || colorName;
                        btn.style.backgroundColor = cssColor;

                        // Se for branco ou claro, bota borda
                        if (['#fff', '#ffffff', 'white', 'branco', 'branca', 'bege'].includes(cssColor.toLowerCase())) {
                            btn.style.border = '1px solid #ccc';
                        }

                        btn.title = colorName; // Tooltip com nome da cor
                        btn.onclick = () => {
                            selectColor(btn);
                            document.getElementById('selected-color-name').innerText = colorName;

                            // NEW: Mudar imagem se tiver
                            if (btn.dataset.image) {
                                const mainImg = document.getElementById("modalImage");
                                const zoomRes = document.getElementById("zoomResult");

                                // Efeito fade
                                mainImg.style.opacity = '0.5';
                                setTimeout(() => {
                                    mainImg.src = btn.dataset.image;
                                    zoomRes.style.backgroundImage = `url('${btn.dataset.image}')`;
                                    mainImg.style.opacity = '1';
                                }, 150);
                            }
                        };
                        colorContainer.appendChild(btn);

                        // Set initial color name
                        if (index === 0) document.getElementById('selected-color-name').innerText = colorName;
                    });
                } else {
                    colorContainer.innerHTML = '<span style="color:#666; font-size: 0.9rem;">Cor Única</span>';
                    document.getElementById('selected-color-name').innerText = '';
                }

            } else {
                // Fallback para produtos sem variantes (Tamanho Único)
                sizeContainer.innerHTML = '<button class="size-btn selected">UN</button>';
                colorContainer.innerHTML = '<button class="color-btn selected" style="background-color: #1a2744;" title="Cor Padrão"></button>';
                document.getElementById('selected-color-name').innerText = 'Padrão';
            }

            modal.style.display = "block";
        }

        // Seleção de Tamanho e Cor
        window.selectSize = (btn) => {
            document.querySelectorAll('.size-btn').forEach(b => b.classList.remove('selected'));
            btn.classList.add('selected');
        };

        window.selectColor = (btn) => {
            document.querySelectorAll('.color-btn').forEach(b => b.classList.remove('selected'));
            btn.classList.add('selected');
            if (btn.title) document.getElementById('selected-color-name').innerText = btn.title;
        }

        // Ações de Compra
        window.checkout = () => {
            const product = {
                title: document.getElementById("modalTitle").innerText,
                price: document.getElementById("modalPrice").innerText,
                img: document.getElementById("modalImage").src,
                size: document.querySelector('.size-btn.selected') ? document.querySelector('.size-btn.selected').innerText : 'Padrão',
                color: document.querySelector('.color-btn.selected') ? (document.querySelector('.color-btn.selected').title || document.getElementById('selected-color-name').innerText || 'Padrão') : 'Padrão',
                yampi_token: currentProductToken || null
            };

            // VERIFICAÇÃO DE SEGURANÇA: Se a cor ainda for RGB, tenta limpar
            if (product.color.includes('rgb(')) {
                product.color = document.getElementById('selected-color-name').innerText || 'Padrão';
            }

            // Salvar no LocalStorage
            let cart = JSON.parse(localStorage.getItem('cart')) || [];
            cart.push(product);
            localStorage.setItem('cart', JSON.stringify(cart));

            // Atualizar badge do carrinho
            updateCartCount(cart.length);

            // Redirecionar para o carrinho
            window.location.href = "cart.html";
        };

        function updateCartCount(count) {
            const badges = document.querySelectorAll('.cart-count');
            badges.forEach(b => b.textContent = count);
        }

        window.buyWhatsapp = () => {
            const product = document.getElementById("modalTitle").innerText;
            const price = document.getElementById("modalPrice").innerText;
            const size = document.querySelector('.size-btn.selected').innerText;

            const text = `Olá! Tenho interesse no *${product}* (Tam: ${size}) por *${price}*.`;
            const url = `https://wa.me/5511999999999?text=${encodeURIComponent(text)}`;
            window.open(url, '_blank');
        };

        // Lógica de Zoom (Lente Espiă)
        container.addEventListener("mousemove", moveLens);
        container.addEventListener("mouseleave", () => {
            lens.style.display = "none";
            result.style.display = "none";
        });

        container.addEventListener("mouseenter", () => {
            // Só ativa zoom em desktop
            if (window.innerWidth > 768) {
                lens.style.display = "block";
                result.style.display = "block";
            }
        });

        function moveLens(e) {
            e.preventDefault();

            // Posição do mouse relativa à imagem
            const pos = getCursorPos(e);
            let x = pos.x - (lens.offsetWidth / 2);
            let y = pos.y - (lens.offsetHeight / 2);

            // Limites da lente
            if (x > modalImg.width - lens.offsetWidth) { x = modalImg.width - lens.offsetWidth; }
            if (x < 0) { x = 0; }
            if (y > modalImg.height - lens.offsetHeight) { y = modalImg.height - lens.offsetHeight; }
            if (y < 0) { y = 0; }

            // Mover lente
            lens.style.left = x + "px";
            lens.style.top = y + "px";

            // Mover background do resultado (Zoom 2.5x)
            const cx = result.offsetWidth / lens.offsetWidth;
            const cy = result.offsetHeight / lens.offsetHeight;

            result.style.backgroundSize = (modalImg.width * cx) + "px " + (modalImg.height * cy) + "px";
            result.style.backgroundPosition = "-" + (x * cx) + "px -" + (y * cy) + "px";
        }

        function getCursorPos(e) {
            let a, x = 0, y = 0;
            e = e || window.event;
            a = modalImg.getBoundingClientRect();
            x = e.pageX - a.left;
            y = e.pageY - a.top;
            x = x - window.pageXOffset;
            y = y - window.pageYOffset;
            return { x: x, y: y };
        }

        // Ativar listeners nos cards de produto
        document.querySelectorAll('.product-card').forEach(card => {
            const btn = card.querySelector('.add-to-cart-btn');
            const imgWrapper = card.querySelector('.product-image-wrapper');

            const getData = () => ({
                img: card.querySelector('img').src,
                title: card.querySelector('.product-title').innerText,
                price: card.querySelector('.price-current').innerText,
                oldPrice: card.querySelector('.price-old').innerText,
                installment: card.querySelector('.installment').innerText,
                category: card.querySelector('.product-category').innerText
            });

            btn.onclick = (e) => { e.preventDefault(); openProductModal(getData()); };
            imgWrapper.onclick = (e) => { e.preventDefault(); openProductModal(getData()); };
        });

        // Carregar Categorias Dinamicamente
        async function initCategories() {
            try {
                const response = await fetch('/api/categories');
                const categories = await response.json();
                const activeCategories = categories.filter(c => c.active).sort((a, b) => (a.order || 0) - (b.order || 0));

                const container = document.getElementById('categories-container');
                if (!container) return;

                if (activeCategories.length > 0) {
                    container.innerHTML = activeCategories.map(cat => `
                        <div class="category-card" onclick="window.location.href='#products'">
                            <div class="category-icon">
                                <i class="fas ${cat.icon || 'fa-tag'}"></i>
                            </div>
                            <h3>${cat.name}</h3>
                            <p>${cat.description || ''}</p>
                        </div>
                    `).join('');
                }
            } catch (err) {
                console.error('Erro ao carregar categorias:', err);
            }
        }

        document.addEventListener('DOMContentLoaded', () => {
            initCategories();
        });

    </script>
</body>

</html>